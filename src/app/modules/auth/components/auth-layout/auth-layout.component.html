<!-- Main Container with Background -->
<div 
  [class]="containerClasses"
  [ngStyle]="backgroundStyle"
>
  <!-- Overlay for better text readability on background images -->
  <div 
    *ngIf="backgroundImage" 
    class="absolute inset-0 bg-black/20 z-0"
  ></div>

  <!-- Content Container -->
  <div class="relative z-10 flex flex-col min-h-screen">
    
    <!-- Header Section -->
    <header class="flex-shrink-0 py-8 px-4">
      <div class="max-w-md mx-auto text-center">
        
        <!-- Logo -->
        <div *ngIf="showLogo" class="mb-6">
          <img 
            [src]="logoUrl" 
            [alt]="logoAlt"
            class="h-16 w-auto mx-auto"
            onerror="this.style.display='none'"
          />
          
          <!-- Fallback if logo fails to load -->
          <div class="h-16 w-16 mx-auto bg-primary-600 rounded-lg flex items-center justify-center text-white font-bold text-xl"
               *ngIf="!logoUrl">
            {{ companyName.charAt(0) }}
          </div>
        </div>

        <!-- Company Info -->
        <div class="space-y-2">
          <h1 class="text-2xl font-bold text-gray-900">
            {{ companyName }}
          </h1>
          <p *ngIf="subtitle" class="text-gray-600">
            {{ subtitle }}
          </p>
        </div>
      </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 flex items-center justify-center px-4 py-8">
      <div class="w-full max-w-md">
        
        <!-- Global Loading Overlay -->
        <pym-loading 
          *ngIf="globalLoading"
          type="spinner"
          text="Cargando..."
          [overlay]="true"
        ></pym-loading>

        <!-- Global Error Alert -->
        <pym-alert
          *ngIf="globalError"
          type="error"
          [dismissible]="true"
          (dismissed)="onErrorDismiss()"
          class="mb-6"
        >
          {{ globalError }}
        </pym-alert>

        <!-- Auth Form Card -->
        <pym-card 
          class="auth-form-card"
          [shadow]="true"
          [bordered]="false"
        >
          <!-- Router Outlet for Auth Forms -->
          <router-outlet></router-outlet>
        </pym-card>

        <!-- Additional Info or Links -->
        <div class="mt-6 text-center">
          <ng-content select="[slot=additional-info]"></ng-content>
        </div>
      </div>
    </main>

    <!-- Footer Section -->
    <footer *ngIf="showFooter" class="flex-shrink-0 py-6 px-4">
      <div class="max-w-md mx-auto text-center">
        <div class="space-y-2 text-sm text-gray-500">
          <p>Â© {{ currentYear }} {{ companyName }}. Todos los derechos reservados.</p>
          
          <!-- Footer Links -->
          <div class="flex justify-center space-x-4">
            <ng-content select="[slot=footer-links]"></ng-content>
          </div>
        </div>
      </div>
    </footer>
  </div>
</div>

<!-- Styles for Auth Layout -->
<style>
  .auth-form-card {
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.95);
  }

  /* Animation for smooth entry */
  .auth-form-card {
    animation: slideInUp 0.4s ease-out;
  }

  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Focus styles for better accessibility */
  .auth-form-card :focus {
    outline: 2px solid var(--pym-primary-500);
    outline-offset: 2px;
  }

  /* Responsive adjustments */
  @media (max-width: 640px) {
    .auth-form-card {
      margin: 0 1rem;
    }
  }
</style>